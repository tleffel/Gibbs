---
title: "Gibbs Free Energy for Silica Glass Fiber Draws"
output: html_notebook
---

## Gibbs Free Energy Equation
### &nbsp;&nbsp;&nbsp;&nbsp; dG = dH(kJ/mol) - T*S(J/mol)*E-3
### &nbsp;&nbsp;&nbsp;&nbsp; dG = G(products) - G(reactants)
### &nbsp;&nbsp;&nbsp;&nbsp; if dG > 0, reaction will propagate backward
### &nbsp;&nbsp;&nbsp;&nbsp; if dG < 0, reaction will propogate forward

## Schomate Equation
### &nbsp;&nbsp;&nbsp;&nbsp; dH(kJ/mol) = A*t + (B*t^2)/2 + (C*t^3)/3 + (D*t^4)/4 - E/t + F - H
### &nbsp;&nbsp;&nbsp;&nbsp; S(J/mol) = A*ln(t) + B*t + (C*t^2)/2 + (D*t^3)/3 - E/(2*t^2) + G
#### &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; t = T/1000

### Upload libraries
```{r}
library(ggplot2)
library(readxl)
library(dplyr)
```

### Upload dataset and grab relevant data
```{r}
dataset <- read_excel('ThermodynamicPropertiesData.xlsx')

dataGibbs <- dataset[-c(24:29, 40:52), ]
```

### Create temperature array
```{r}
lowTemp <- 293
highTemp <- 2600
T <- c(lowTemp:highTemp)
t <- T/1000
max_Temps <- c(dataGibbs$Max_Temp)
coefficient_Names <- c("A", "B", "C", "D", "E", "F", "G", "H")
coefficients <- as.matrix(dataGibbs %>% select(3:10))
```

```{r}
H_t = matrix(c(t, t^2/2, t^3/3, t^4/4, -1/t, t^0, 0*t, -t^0), nrow = 2308, ncol = 8, dimnames = list(T, coefficient_Names))
S_t = matrix(c(log(t), t, t^2/2, t^3/3, -1/(2*t^2), 0*t, t^0, 0*t), nrow = 2308, ncol = 8, dimnames = list(T, coefficient_Names))
```

```{r}
H = coefficients[1] %*% H_t[1]
```

```{r}
for(i in length(coefficients)) H[i] <- H_t %*% coefficients[i]
```

